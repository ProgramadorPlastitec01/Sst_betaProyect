{% extends 'base.html' %}
{% load static %}

{% block title %}SST - Detalle Inspección Montacargas{% endblock %}

{% block header_title %}Detalle de Inspección de Montacargas{% endblock %}

{% block content %}
<div class="inspection-form-container" style="max-width: 1000px;">
    <div class="dashboard-header">
        <div>
            <h1 style="font-size: 1.5rem; font-weight: 700;">Detalle de Inspección Diaria</h1>
            <p style="color: var(--text-light); font-size: 0.9rem;">Realizada por {{ object.inspector }} el {{
                object.inspection_date|date:"d/m/Y" }}</p>
        </div>
        <div style="display: flex; gap: 12px;">
            <a href="{% url 'forklift_list' %}" class="btn" style="background: #e9ecef; color: #495057;"><i
                    class="fas fa-arrow-left"></i> Volver</a>
            <button onclick="window.print()" class="btn" style="background: #6c757d; color: white;"><i
                    class="fas fa-print"></i> Imprimir</button>
            <a href="{% url 'forklift_edit' object.pk %}" class="btn btn-primary"><i class="fas fa-edit"></i> Editar</a>
        </div>
    </div>

    <div class="card">
        <h3 class="inspection-section-title"><i class="fas fa-info-circle"></i> Información del Equipo</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 24px;">
            <div>
                <label
                    style="display: block; font-size: 0.75rem; color: var(--text-light); text-transform: uppercase; font-weight: 700; margin-bottom: 5px;">Fecha</label>
                <div style="font-weight: 600;">{{ object.inspection_date }}</div>
            </div>
            <div>
                <label
                    style="display: block; font-size: 0.75rem; color: var(--text-light); text-transform: uppercase; font-weight: 700; margin-bottom: 5px;">Área</label>
                <div style="font-weight: 600;">{{ object.area }}</div>
            </div>
            <div>
                <label
                    style="display: block; font-size: 0.75rem; color: var(--text-light); text-transform: uppercase; font-weight: 700; margin-bottom: 5px;">Tipo
                    de Equipo</label>
                <div style="font-weight: 600;">{{ object.get_forklift_type_display }}</div>
            </div>
            <div>
                <label
                    style="display: block; font-size: 0.75rem; color: var(--text-light); text-transform: uppercase; font-weight: 700; margin-bottom: 5px;">Estado
                    General</label>
                <span
                    class="compliance-badge {% if object.general_status == 'Cumple' %}badge-success{% elif object.general_status == 'No Cumple' %}badge-danger{% else %}badge-secondary{% endif %}">
                    {{ object.general_status }}
                </span>
            </div>
        </div>

        <div style="margin-top: 24px; color: var(--text-light); font-size: 0.75rem; font-weight: 600;">
            DOCUMENTO: R-RH-SST-022 V.002
        </div>
    </div>

    <div class="card">
        <h3 class="inspection-section-title"><i class="fas fa-tasks"></i> Resultados de la Verificación</h3>
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th style="width: 55%;">ÍTEM Y ELEMENTO EVALUADO</th>
                        <th style="width: 120px; text-align: center;">CUMPLIMIENTO</th>
                        <th>OBSERVACIONES</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in object.items.all %}
                    <tr>
                        <td style="font-weight: 500;">{{ item.question }}</td>
                        <td style="text-align: center;">
                            {% if item.response == 'Si' %}
                            <span style="color: #28a745; font-weight: 700;"><i class="fas fa-check"></i> SÍ</span>
                            {% elif item.response == 'No' %}
                            <span style="color: #dc3545; font-weight: 700;"><i class="fas fa-times"></i> NO</span>
                            {% else %}
                            <span style="color: #6c757d; font-weight: 700;">- N/A</span>
                            {% endif %}
                        </td>
                        <td style="font-size: 0.85rem; font-style: italic;">{{ item.observations|default:"-" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    {% if object.observations %}
    <div class="card">
        <h3 class="inspection-section-title"><i class="fas fa-comment-dots"></i> Observaciones Generales</h3>
        <div
            style="background: #f8faf9; padding: 20px; border-radius: 12px; border-left: 4px solid var(--primary-color);">
            {{ object.observations|linebreaks }}
        </div>
    </div>
    {% endif %}

    <div
        style="margin-top: 48px; display: grid; grid-template-columns: 1fr 1fr; gap: 60px; text-align: center; padding-bottom: 40px;">
        <div>
            <div
                style="height: 60px; border-bottom: 2px solid var(--text-dark); margin-bottom: 12px; display: flex; align-items: flex-end; justify-content: center; font-family: cursive;">
                {{ object.inspector }}
            </div>
            <p style="font-weight: 700; margin: 0; font-size: 0.9rem;">{{ object.inspector }}</p>
            <p style="font-size: 0.75rem; color: var(--text-light); text-transform: uppercase; font-weight: 600;">Firma
                de quien realiza el chequeo</p>
        </div>
        <div>
            <div style="height: 60px; border-bottom: 2px solid var(--text-dark); margin-bottom: 12px;"></div>
            <p style="font-weight: 700; margin: 0; font-size: 0.9rem;">Operador / Supervisor</p>
            <p style="font-size: 0.75rem; color: var(--text-light); text-transform: uppercase; font-weight: 600;">Firma
                de quien recibe la inspección</p>
        </div>
    </div>
</div>

{% endblock %}